from datetime import datetime, timedelta
from airflow import DAG
from airflow.utils.weight_rule import WeightRule
from airflow.operators.docker_plugin import DockerWithVariablesOperator

default_args = {
    'owner': 'airflow',
    'depends_on_past': False,
    'start_date': datetime(2018, 2, 28),
    'cactchup_by_default': False,
    'retries': 100,
    'retry_delay': timedelta(seconds=2),
    'retry_exponential_backoff': True,
    }
dag = DAG(
    "pinky_gt_ws", default_args=default_args, schedule_interval=None)

ws_image = "ranlu/watershed:pinkygt"
agg_image = "ranlu/agglomeration:pinkygt"

def atomic_chunks_op(dag, tags):
    cmdlist = " && ".join(["/root/ws/scripts/atomic_chunk_ws.sh {}.json".format(tag) for tag in tags])
    return DockerWithVariablesOperator(
        ['google-secret.json', 'config.sh'],
        mount_point='/root/.cloudvolume/secrets/',
        task_id='atomic_chunk_' + tags[0],
        command='/bin/bash -c "cp /root/ws/test/*.json $AIRFLOW_TMP_DIR && cd $AIRFLOW_TMP_DIR && {} && rm -rf $AIRFLOW_TMP_DIR/*"'.format(cmdlist),
        default_args=default_args,
        image=ws_image,
        weight_rule=WeightRule.ABSOLUTE,
        execution_timeout=timedelta(minutes=10),
        queue="atomic",
        dag=dag
    )

def composite_chunks_op(dag, tags):
    cmdlist = " && ".join(["/root/ws/scripts/composite_chunk_ws.sh {}.json".format(tag) for tag in tags])
    return DockerWithVariablesOperator(
        ['google-secret.json', 'config.sh'],
        mount_point='/root/.cloudvolume/secrets/',
        task_id='composite_chunk_' + tags[0],
        command='/bin/bash -c "cp /root/ws/test/*.json $AIRFLOW_TMP_DIR && cd $AIRFLOW_TMP_DIR && {} && rm -rf $AIRFLOW_TMP_DIR/*"'.format(cmdlist),
        default_args=default_args,
        image=ws_image,
        weight_rule=WeightRule.ABSOLUTE,
        execution_timeout=timedelta(minutes=10),
        queue="atomic",
        dag=dag
    )

def remap_chunks_op(dag, tags):
    cmdlist = " && ".join(["/root/ws/scripts/remap_chunk.sh {}.json".format(tag) for tag in tags])
    return DockerWithVariablesOperator(
        ['google-secret.json', 'config.sh'],
        mount_point='/root/.cloudvolume/secrets/',
        task_id='remap_chunk_' + tags[0],
        command='/bin/bash -c "cp /root/ws/test/*.json $AIRFLOW_TMP_DIR && cd $AIRFLOW_TMP_DIR && {} && rm -rf $AIRFLOW_TMP_DIR/*"'.format(cmdlist),
        default_args=default_args,
        image=ws_image,
        weight_rule=WeightRule.ABSOLUTE,
        execution_timeout=timedelta(minutes=10),
        queue="atomic",
        dag=dag
    )

generate_chunks = {}
remap_chunks = {}

generate_chunks["3_0_0_0"]=composite_chunks_op(dag, ["3_0_0_0"])
generate_chunks["2_0_0_0"]=composite_chunks_op(dag, ["2_0_0_0"])
generate_chunks["2_0_1_0"]=composite_chunks_op(dag, ["2_0_1_0"])
generate_chunks["2_1_0_0"]=composite_chunks_op(dag, ["2_1_0_0"])
generate_chunks["2_1_1_0"]=composite_chunks_op(dag, ["2_1_1_0"])
generate_chunks["1_0_0_0"]=composite_chunks_op(dag, ["1_0_0_0"])
generate_chunks["1_0_0_0_0"]=atomic_chunks_op(dag, ["0_0_0_0"])
remap_chunks["1_0_0_0_0"]=remap_chunks_op(dag, ["0_0_0_0"])
generate_chunks["1_0_0_0_1"]=atomic_chunks_op(dag, ["0_0_1_0"])
remap_chunks["1_0_0_0_1"]=remap_chunks_op(dag, ["0_0_1_0"])
generate_chunks["1_0_0_0_2"]=atomic_chunks_op(dag, ["0_1_0_0"])
remap_chunks["1_0_0_0_2"]=remap_chunks_op(dag, ["0_1_0_0"])
generate_chunks["1_0_0_0_3"]=atomic_chunks_op(dag, ["0_1_1_0"])
remap_chunks["1_0_0_0_3"]=remap_chunks_op(dag, ["0_1_1_0"])
generate_chunks["1_0_1_0"]=composite_chunks_op(dag, ["1_0_1_0"])
generate_chunks["1_0_1_0_0"]=atomic_chunks_op(dag, ["0_0_2_0"])
remap_chunks["1_0_1_0_0"]=remap_chunks_op(dag, ["0_0_2_0"])
generate_chunks["1_0_1_0_1"]=atomic_chunks_op(dag, ["0_0_3_0"])
remap_chunks["1_0_1_0_1"]=remap_chunks_op(dag, ["0_0_3_0"])
generate_chunks["1_0_1_0_2"]=atomic_chunks_op(dag, ["0_1_2_0"])
remap_chunks["1_0_1_0_2"]=remap_chunks_op(dag, ["0_1_2_0"])
generate_chunks["1_0_1_0_3"]=atomic_chunks_op(dag, ["0_1_3_0"])
remap_chunks["1_0_1_0_3"]=remap_chunks_op(dag, ["0_1_3_0"])
generate_chunks["1_1_0_0"]=composite_chunks_op(dag, ["1_1_0_0"])
generate_chunks["1_1_0_0_0"]=atomic_chunks_op(dag, ["0_2_0_0"])
remap_chunks["1_1_0_0_0"]=remap_chunks_op(dag, ["0_2_0_0"])
generate_chunks["1_1_0_0_1"]=atomic_chunks_op(dag, ["0_2_1_0"])
remap_chunks["1_1_0_0_1"]=remap_chunks_op(dag, ["0_2_1_0"])
generate_chunks["1_1_0_0_2"]=atomic_chunks_op(dag, ["0_3_0_0"])
remap_chunks["1_1_0_0_2"]=remap_chunks_op(dag, ["0_3_0_0"])
generate_chunks["1_1_0_0_3"]=atomic_chunks_op(dag, ["0_3_1_0"])
remap_chunks["1_1_0_0_3"]=remap_chunks_op(dag, ["0_3_1_0"])
generate_chunks["1_1_1_0"]=composite_chunks_op(dag, ["1_1_1_0"])
generate_chunks["1_1_1_0_0"]=atomic_chunks_op(dag, ["0_2_2_0"])
remap_chunks["1_1_1_0_0"]=remap_chunks_op(dag, ["0_2_2_0"])
generate_chunks["1_1_1_0_1"]=atomic_chunks_op(dag, ["0_2_3_0"])
remap_chunks["1_1_1_0_1"]=remap_chunks_op(dag, ["0_2_3_0"])
generate_chunks["1_1_1_0_2"]=atomic_chunks_op(dag, ["0_3_2_0"])
remap_chunks["1_1_1_0_2"]=remap_chunks_op(dag, ["0_3_2_0"])
generate_chunks["1_1_1_0_3"]=atomic_chunks_op(dag, ["0_3_3_0"])
remap_chunks["1_1_1_0_3"]=remap_chunks_op(dag, ["0_3_3_0"])
generate_chunks["1_0_2_0"]=composite_chunks_op(dag, ["1_0_2_0"])
generate_chunks["1_0_2_0_0"]=atomic_chunks_op(dag, ["0_0_4_0"])
remap_chunks["1_0_2_0_0"]=remap_chunks_op(dag, ["0_0_4_0"])
generate_chunks["1_0_2_0_1"]=atomic_chunks_op(dag, ["0_0_5_0"])
remap_chunks["1_0_2_0_1"]=remap_chunks_op(dag, ["0_0_5_0"])
generate_chunks["1_0_2_0_2"]=atomic_chunks_op(dag, ["0_1_4_0"])
remap_chunks["1_0_2_0_2"]=remap_chunks_op(dag, ["0_1_4_0"])
generate_chunks["1_0_2_0_3"]=atomic_chunks_op(dag, ["0_1_5_0"])
remap_chunks["1_0_2_0_3"]=remap_chunks_op(dag, ["0_1_5_0"])
generate_chunks["1_0_3_0"]=composite_chunks_op(dag, ["1_0_3_0"])
generate_chunks["1_0_3_0_0"]=atomic_chunks_op(dag, ["0_0_6_0"])
remap_chunks["1_0_3_0_0"]=remap_chunks_op(dag, ["0_0_6_0"])
generate_chunks["1_0_3_0_1"]=atomic_chunks_op(dag, ["0_0_7_0"])
remap_chunks["1_0_3_0_1"]=remap_chunks_op(dag, ["0_0_7_0"])
generate_chunks["1_0_3_0_2"]=atomic_chunks_op(dag, ["0_1_6_0"])
remap_chunks["1_0_3_0_2"]=remap_chunks_op(dag, ["0_1_6_0"])
generate_chunks["1_0_3_0_3"]=atomic_chunks_op(dag, ["0_1_7_0"])
remap_chunks["1_0_3_0_3"]=remap_chunks_op(dag, ["0_1_7_0"])
generate_chunks["1_1_2_0"]=composite_chunks_op(dag, ["1_1_2_0"])
generate_chunks["1_1_2_0_0"]=atomic_chunks_op(dag, ["0_2_4_0"])
remap_chunks["1_1_2_0_0"]=remap_chunks_op(dag, ["0_2_4_0"])
generate_chunks["1_1_2_0_1"]=atomic_chunks_op(dag, ["0_2_5_0"])
remap_chunks["1_1_2_0_1"]=remap_chunks_op(dag, ["0_2_5_0"])
generate_chunks["1_1_2_0_2"]=atomic_chunks_op(dag, ["0_3_4_0"])
remap_chunks["1_1_2_0_2"]=remap_chunks_op(dag, ["0_3_4_0"])
generate_chunks["1_1_2_0_3"]=atomic_chunks_op(dag, ["0_3_5_0"])
remap_chunks["1_1_2_0_3"]=remap_chunks_op(dag, ["0_3_5_0"])
generate_chunks["1_1_3_0"]=composite_chunks_op(dag, ["1_1_3_0"])
generate_chunks["1_1_3_0_0"]=atomic_chunks_op(dag, ["0_2_6_0"])
remap_chunks["1_1_3_0_0"]=remap_chunks_op(dag, ["0_2_6_0"])
generate_chunks["1_1_3_0_1"]=atomic_chunks_op(dag, ["0_2_7_0"])
remap_chunks["1_1_3_0_1"]=remap_chunks_op(dag, ["0_2_7_0"])
generate_chunks["1_1_3_0_2"]=atomic_chunks_op(dag, ["0_3_6_0"])
remap_chunks["1_1_3_0_2"]=remap_chunks_op(dag, ["0_3_6_0"])
generate_chunks["1_1_3_0_3"]=atomic_chunks_op(dag, ["0_3_7_0"])
remap_chunks["1_1_3_0_3"]=remap_chunks_op(dag, ["0_3_7_0"])
generate_chunks["1_2_0_0"]=composite_chunks_op(dag, ["1_2_0_0"])
generate_chunks["1_2_0_0_0"]=atomic_chunks_op(dag, ["0_4_0_0"])
remap_chunks["1_2_0_0_0"]=remap_chunks_op(dag, ["0_4_0_0"])
generate_chunks["1_2_0_0_1"]=atomic_chunks_op(dag, ["0_4_1_0"])
remap_chunks["1_2_0_0_1"]=remap_chunks_op(dag, ["0_4_1_0"])
generate_chunks["1_2_0_0_2"]=atomic_chunks_op(dag, ["0_5_0_0"])
remap_chunks["1_2_0_0_2"]=remap_chunks_op(dag, ["0_5_0_0"])
generate_chunks["1_2_0_0_3"]=atomic_chunks_op(dag, ["0_5_1_0"])
remap_chunks["1_2_0_0_3"]=remap_chunks_op(dag, ["0_5_1_0"])
generate_chunks["1_2_1_0"]=composite_chunks_op(dag, ["1_2_1_0"])
generate_chunks["1_2_1_0_0"]=atomic_chunks_op(dag, ["0_4_2_0"])
remap_chunks["1_2_1_0_0"]=remap_chunks_op(dag, ["0_4_2_0"])
generate_chunks["1_2_1_0_1"]=atomic_chunks_op(dag, ["0_4_3_0"])
remap_chunks["1_2_1_0_1"]=remap_chunks_op(dag, ["0_4_3_0"])
generate_chunks["1_2_1_0_2"]=atomic_chunks_op(dag, ["0_5_2_0"])
remap_chunks["1_2_1_0_2"]=remap_chunks_op(dag, ["0_5_2_0"])
generate_chunks["1_2_1_0_3"]=atomic_chunks_op(dag, ["0_5_3_0"])
remap_chunks["1_2_1_0_3"]=remap_chunks_op(dag, ["0_5_3_0"])
generate_chunks["1_3_0_0"]=composite_chunks_op(dag, ["1_3_0_0"])
generate_chunks["1_3_0_0_0"]=atomic_chunks_op(dag, ["0_6_0_0"])
remap_chunks["1_3_0_0_0"]=remap_chunks_op(dag, ["0_6_0_0"])
generate_chunks["1_3_0_0_1"]=atomic_chunks_op(dag, ["0_6_1_0"])
remap_chunks["1_3_0_0_1"]=remap_chunks_op(dag, ["0_6_1_0"])
generate_chunks["1_3_0_0_2"]=atomic_chunks_op(dag, ["0_7_0_0"])
remap_chunks["1_3_0_0_2"]=remap_chunks_op(dag, ["0_7_0_0"])
generate_chunks["1_3_0_0_3"]=atomic_chunks_op(dag, ["0_7_1_0"])
remap_chunks["1_3_0_0_3"]=remap_chunks_op(dag, ["0_7_1_0"])
generate_chunks["1_3_1_0"]=composite_chunks_op(dag, ["1_3_1_0"])
generate_chunks["1_3_1_0_0"]=atomic_chunks_op(dag, ["0_6_2_0"])
remap_chunks["1_3_1_0_0"]=remap_chunks_op(dag, ["0_6_2_0"])
generate_chunks["1_3_1_0_1"]=atomic_chunks_op(dag, ["0_6_3_0"])
remap_chunks["1_3_1_0_1"]=remap_chunks_op(dag, ["0_6_3_0"])
generate_chunks["1_3_1_0_2"]=atomic_chunks_op(dag, ["0_7_2_0"])
remap_chunks["1_3_1_0_2"]=remap_chunks_op(dag, ["0_7_2_0"])
generate_chunks["1_3_1_0_3"]=atomic_chunks_op(dag, ["0_7_3_0"])
remap_chunks["1_3_1_0_3"]=remap_chunks_op(dag, ["0_7_3_0"])
generate_chunks["1_2_2_0"]=composite_chunks_op(dag, ["1_2_2_0"])
generate_chunks["1_2_2_0_0"]=atomic_chunks_op(dag, ["0_4_4_0"])
remap_chunks["1_2_2_0_0"]=remap_chunks_op(dag, ["0_4_4_0"])
generate_chunks["1_2_2_0_1"]=atomic_chunks_op(dag, ["0_4_5_0"])
remap_chunks["1_2_2_0_1"]=remap_chunks_op(dag, ["0_4_5_0"])
generate_chunks["1_2_2_0_2"]=atomic_chunks_op(dag, ["0_5_4_0"])
remap_chunks["1_2_2_0_2"]=remap_chunks_op(dag, ["0_5_4_0"])
generate_chunks["1_2_2_0_3"]=atomic_chunks_op(dag, ["0_5_5_0"])
remap_chunks["1_2_2_0_3"]=remap_chunks_op(dag, ["0_5_5_0"])
generate_chunks["1_2_3_0"]=composite_chunks_op(dag, ["1_2_3_0"])
generate_chunks["1_2_3_0_0"]=atomic_chunks_op(dag, ["0_4_6_0"])
remap_chunks["1_2_3_0_0"]=remap_chunks_op(dag, ["0_4_6_0"])
generate_chunks["1_2_3_0_1"]=atomic_chunks_op(dag, ["0_4_7_0"])
remap_chunks["1_2_3_0_1"]=remap_chunks_op(dag, ["0_4_7_0"])
generate_chunks["1_2_3_0_2"]=atomic_chunks_op(dag, ["0_5_6_0"])
remap_chunks["1_2_3_0_2"]=remap_chunks_op(dag, ["0_5_6_0"])
generate_chunks["1_2_3_0_3"]=atomic_chunks_op(dag, ["0_5_7_0"])
remap_chunks["1_2_3_0_3"]=remap_chunks_op(dag, ["0_5_7_0"])
generate_chunks["1_3_2_0"]=composite_chunks_op(dag, ["1_3_2_0"])
generate_chunks["1_3_2_0_0"]=atomic_chunks_op(dag, ["0_6_4_0"])
remap_chunks["1_3_2_0_0"]=remap_chunks_op(dag, ["0_6_4_0"])
generate_chunks["1_3_2_0_1"]=atomic_chunks_op(dag, ["0_6_5_0"])
remap_chunks["1_3_2_0_1"]=remap_chunks_op(dag, ["0_6_5_0"])
generate_chunks["1_3_2_0_2"]=atomic_chunks_op(dag, ["0_7_4_0"])
remap_chunks["1_3_2_0_2"]=remap_chunks_op(dag, ["0_7_4_0"])
generate_chunks["1_3_2_0_3"]=atomic_chunks_op(dag, ["0_7_5_0"])
remap_chunks["1_3_2_0_3"]=remap_chunks_op(dag, ["0_7_5_0"])
generate_chunks["1_3_3_0"]=composite_chunks_op(dag, ["1_3_3_0"])
generate_chunks["1_3_3_0_0"]=atomic_chunks_op(dag, ["0_6_6_0"])
remap_chunks["1_3_3_0_0"]=remap_chunks_op(dag, ["0_6_6_0"])
generate_chunks["1_3_3_0_1"]=atomic_chunks_op(dag, ["0_6_7_0"])
remap_chunks["1_3_3_0_1"]=remap_chunks_op(dag, ["0_6_7_0"])
generate_chunks["1_3_3_0_2"]=atomic_chunks_op(dag, ["0_7_6_0"])
remap_chunks["1_3_3_0_2"]=remap_chunks_op(dag, ["0_7_6_0"])
generate_chunks["1_3_3_0_3"]=atomic_chunks_op(dag, ["0_7_7_0"])
remap_chunks["1_3_3_0_3"]=remap_chunks_op(dag, ["0_7_7_0"])
generate_chunks["2_0_0_0"].set_downstream(generate_chunks["3_0_0_0"])
generate_chunks["2_0_1_0"].set_downstream(generate_chunks["3_0_0_0"])
generate_chunks["2_1_0_0"].set_downstream(generate_chunks["3_0_0_0"])
generate_chunks["2_1_1_0"].set_downstream(generate_chunks["3_0_0_0"])
generate_chunks["1_0_0_0"].set_downstream(generate_chunks["2_0_0_0"])
generate_chunks["1_0_1_0"].set_downstream(generate_chunks["2_0_0_0"])
generate_chunks["1_1_0_0"].set_downstream(generate_chunks["2_0_0_0"])
generate_chunks["1_1_1_0"].set_downstream(generate_chunks["2_0_0_0"])
generate_chunks["1_0_2_0"].set_downstream(generate_chunks["2_0_1_0"])
generate_chunks["1_0_3_0"].set_downstream(generate_chunks["2_0_1_0"])
generate_chunks["1_1_2_0"].set_downstream(generate_chunks["2_0_1_0"])
generate_chunks["1_1_3_0"].set_downstream(generate_chunks["2_0_1_0"])
generate_chunks["1_2_0_0"].set_downstream(generate_chunks["2_1_0_0"])
generate_chunks["1_2_1_0"].set_downstream(generate_chunks["2_1_0_0"])
generate_chunks["1_3_0_0"].set_downstream(generate_chunks["2_1_0_0"])
generate_chunks["1_3_1_0"].set_downstream(generate_chunks["2_1_0_0"])
generate_chunks["1_2_2_0"].set_downstream(generate_chunks["2_1_1_0"])
generate_chunks["1_2_3_0"].set_downstream(generate_chunks["2_1_1_0"])
generate_chunks["1_3_2_0"].set_downstream(generate_chunks["2_1_1_0"])
generate_chunks["1_3_3_0"].set_downstream(generate_chunks["2_1_1_0"])
generate_chunks["1_0_0_0_0"].set_downstream(generate_chunks["1_0_0_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_0_0_0_0"])
generate_chunks["1_0_0_0_1"].set_downstream(generate_chunks["1_0_0_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_0_0_0_1"])
generate_chunks["1_0_0_0_2"].set_downstream(generate_chunks["1_0_0_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_0_0_0_2"])
generate_chunks["1_0_0_0_3"].set_downstream(generate_chunks["1_0_0_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_0_0_0_3"])
generate_chunks["1_0_1_0_0"].set_downstream(generate_chunks["1_0_1_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_0_1_0_0"])
generate_chunks["1_0_1_0_1"].set_downstream(generate_chunks["1_0_1_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_0_1_0_1"])
generate_chunks["1_0_1_0_2"].set_downstream(generate_chunks["1_0_1_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_0_1_0_2"])
generate_chunks["1_0_1_0_3"].set_downstream(generate_chunks["1_0_1_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_0_1_0_3"])
generate_chunks["1_1_0_0_0"].set_downstream(generate_chunks["1_1_0_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_1_0_0_0"])
generate_chunks["1_1_0_0_1"].set_downstream(generate_chunks["1_1_0_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_1_0_0_1"])
generate_chunks["1_1_0_0_2"].set_downstream(generate_chunks["1_1_0_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_1_0_0_2"])
generate_chunks["1_1_0_0_3"].set_downstream(generate_chunks["1_1_0_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_1_0_0_3"])
generate_chunks["1_1_1_0_0"].set_downstream(generate_chunks["1_1_1_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_1_1_0_0"])
generate_chunks["1_1_1_0_1"].set_downstream(generate_chunks["1_1_1_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_1_1_0_1"])
generate_chunks["1_1_1_0_2"].set_downstream(generate_chunks["1_1_1_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_1_1_0_2"])
generate_chunks["1_1_1_0_3"].set_downstream(generate_chunks["1_1_1_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_1_1_0_3"])
generate_chunks["1_0_2_0_0"].set_downstream(generate_chunks["1_0_2_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_0_2_0_0"])
generate_chunks["1_0_2_0_1"].set_downstream(generate_chunks["1_0_2_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_0_2_0_1"])
generate_chunks["1_0_2_0_2"].set_downstream(generate_chunks["1_0_2_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_0_2_0_2"])
generate_chunks["1_0_2_0_3"].set_downstream(generate_chunks["1_0_2_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_0_2_0_3"])
generate_chunks["1_0_3_0_0"].set_downstream(generate_chunks["1_0_3_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_0_3_0_0"])
generate_chunks["1_0_3_0_1"].set_downstream(generate_chunks["1_0_3_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_0_3_0_1"])
generate_chunks["1_0_3_0_2"].set_downstream(generate_chunks["1_0_3_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_0_3_0_2"])
generate_chunks["1_0_3_0_3"].set_downstream(generate_chunks["1_0_3_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_0_3_0_3"])
generate_chunks["1_1_2_0_0"].set_downstream(generate_chunks["1_1_2_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_1_2_0_0"])
generate_chunks["1_1_2_0_1"].set_downstream(generate_chunks["1_1_2_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_1_2_0_1"])
generate_chunks["1_1_2_0_2"].set_downstream(generate_chunks["1_1_2_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_1_2_0_2"])
generate_chunks["1_1_2_0_3"].set_downstream(generate_chunks["1_1_2_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_1_2_0_3"])
generate_chunks["1_1_3_0_0"].set_downstream(generate_chunks["1_1_3_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_1_3_0_0"])
generate_chunks["1_1_3_0_1"].set_downstream(generate_chunks["1_1_3_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_1_3_0_1"])
generate_chunks["1_1_3_0_2"].set_downstream(generate_chunks["1_1_3_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_1_3_0_2"])
generate_chunks["1_1_3_0_3"].set_downstream(generate_chunks["1_1_3_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_1_3_0_3"])
generate_chunks["1_2_0_0_0"].set_downstream(generate_chunks["1_2_0_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_2_0_0_0"])
generate_chunks["1_2_0_0_1"].set_downstream(generate_chunks["1_2_0_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_2_0_0_1"])
generate_chunks["1_2_0_0_2"].set_downstream(generate_chunks["1_2_0_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_2_0_0_2"])
generate_chunks["1_2_0_0_3"].set_downstream(generate_chunks["1_2_0_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_2_0_0_3"])
generate_chunks["1_2_1_0_0"].set_downstream(generate_chunks["1_2_1_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_2_1_0_0"])
generate_chunks["1_2_1_0_1"].set_downstream(generate_chunks["1_2_1_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_2_1_0_1"])
generate_chunks["1_2_1_0_2"].set_downstream(generate_chunks["1_2_1_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_2_1_0_2"])
generate_chunks["1_2_1_0_3"].set_downstream(generate_chunks["1_2_1_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_2_1_0_3"])
generate_chunks["1_3_0_0_0"].set_downstream(generate_chunks["1_3_0_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_3_0_0_0"])
generate_chunks["1_3_0_0_1"].set_downstream(generate_chunks["1_3_0_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_3_0_0_1"])
generate_chunks["1_3_0_0_2"].set_downstream(generate_chunks["1_3_0_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_3_0_0_2"])
generate_chunks["1_3_0_0_3"].set_downstream(generate_chunks["1_3_0_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_3_0_0_3"])
generate_chunks["1_3_1_0_0"].set_downstream(generate_chunks["1_3_1_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_3_1_0_0"])
generate_chunks["1_3_1_0_1"].set_downstream(generate_chunks["1_3_1_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_3_1_0_1"])
generate_chunks["1_3_1_0_2"].set_downstream(generate_chunks["1_3_1_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_3_1_0_2"])
generate_chunks["1_3_1_0_3"].set_downstream(generate_chunks["1_3_1_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_3_1_0_3"])
generate_chunks["1_2_2_0_0"].set_downstream(generate_chunks["1_2_2_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_2_2_0_0"])
generate_chunks["1_2_2_0_1"].set_downstream(generate_chunks["1_2_2_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_2_2_0_1"])
generate_chunks["1_2_2_0_2"].set_downstream(generate_chunks["1_2_2_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_2_2_0_2"])
generate_chunks["1_2_2_0_3"].set_downstream(generate_chunks["1_2_2_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_2_2_0_3"])
generate_chunks["1_2_3_0_0"].set_downstream(generate_chunks["1_2_3_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_2_3_0_0"])
generate_chunks["1_2_3_0_1"].set_downstream(generate_chunks["1_2_3_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_2_3_0_1"])
generate_chunks["1_2_3_0_2"].set_downstream(generate_chunks["1_2_3_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_2_3_0_2"])
generate_chunks["1_2_3_0_3"].set_downstream(generate_chunks["1_2_3_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_2_3_0_3"])
generate_chunks["1_3_2_0_0"].set_downstream(generate_chunks["1_3_2_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_3_2_0_0"])
generate_chunks["1_3_2_0_1"].set_downstream(generate_chunks["1_3_2_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_3_2_0_1"])
generate_chunks["1_3_2_0_2"].set_downstream(generate_chunks["1_3_2_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_3_2_0_2"])
generate_chunks["1_3_2_0_3"].set_downstream(generate_chunks["1_3_2_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_3_2_0_3"])
generate_chunks["1_3_3_0_0"].set_downstream(generate_chunks["1_3_3_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_3_3_0_0"])
generate_chunks["1_3_3_0_1"].set_downstream(generate_chunks["1_3_3_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_3_3_0_1"])
generate_chunks["1_3_3_0_2"].set_downstream(generate_chunks["1_3_3_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_3_3_0_2"])
generate_chunks["1_3_3_0_3"].set_downstream(generate_chunks["1_3_3_0"])
generate_chunks["3_0_0_0"].set_downstream(remap_chunks["1_3_3_0_3"])
